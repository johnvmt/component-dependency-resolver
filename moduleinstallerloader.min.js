(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.moduleinstallerloader = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
function Graph(){this._nodes={}}Graph.prototype.getNode=function(e){if(this.hasNode(e))return this._nodes[e].data;throw new Error("node_undefined")},Graph.prototype.addNode=function(e,r){if(this.hasNode(e))throw new Error("node_exists");this._nodes[e]={data:r,indegree:0,edges:[]}},Graph.prototype.hasNode=function(e){return void 0!==this._nodes[e]},Graph.prototype.addEdge=function(e,r){if(!this.hasNode(e))throw new Error("source_node_undefined");if(!this.hasNode(r))throw new Error("sink_node_undefined");var o=this._nodes[e].edges;if(o.indexOf(r)<0){if(o.push(r),this.hasCycle(r))throw o.pop(),new Error("graph_cycle");this._nodes[r].indegree++}},Graph.prototype.depthFirstTraverse=function(){if(1==arguments.length)var e=arguments[0];else if(2==arguments.length)var r=arguments[0],e=arguments[1];else{if(3!=arguments.length)throw new Error("invalid_arguments");var r=arguments[0],o=arguments[1],e=arguments[2]}if(void 0===o)var o={};if(void 0===r)for(var n in this._nodes)this._nodes.hasOwnProperty(n)&&0==this._nodes[n].indegree&&this.depthFirstTraverse(n,o,e);else{if("object"!=typeof this._nodes[r])throw console.log(r),new Error("undefined_node");if("boolean"!=typeof o[r]||!o[r]){o[r]=!0;for(var t in this._nodes[r].edges)this.depthFirstTraverse(this._nodes[r].edges[t],o,e);e(this._nodes[r].data,r)}}},Graph.prototype.hasCycle=function(e,r){if(this.hasNode(e)){var o=this._nodes[e];if(void 0!==r&&Array.isArray(r)||(r=[]),r.indexOf(e)>=0)return!0;r.push(e);for(var n in o.edges){var t=r.slice(0);if(this.hasCycle(o.edges[n],t))return!0}return!1}throw new Error("source_node_undefined")},module.exports=function(){return new Graph};
},{}],2:[function(require,module,exports){
function ModuleLoader(e){this.config=e}var Utils=require("./Utils"),Graph=require("./Graph");ModuleLoader.prototype.load=function(){function e(e,o){var t={};"object"==typeof e.required&&null!=e.required&&Utils.objectForEach(e.required,function(e,o){t[o]=r.modulesLoaded[e]}),r.modulesLoaded[o]=require(e.require)(e.argument,t)}var r=Utils.parseArgs(arguments,[{name:"moduleKey",level:1,validate:function(e,r){return"string"==typeof e}},{name:"modulesConfig",level:0,validate:function(e,r){return"object"==typeof e}},{name:"modulesLoaded",level:1,validate:function(e,r){return"object"==typeof e&&null!=e},default:{}}]),o=this._dependencyGraph(r.modulesConfig);return"string"==typeof r.moduleKey?o.depthFirstTraverse(r.moduleKey,e):o.depthFirstTraverse(e),r.modulesLoaded},ModuleLoader.prototype._dependencyGraph=function(e){var r=Graph();return Utils.objectForEach(e,function(e,o){r.addNode(o,e)}),Utils.objectForEach(e,function(e,o){"object"==typeof e.required&&null!=e.required&&Utils.objectForEach(e.required,function(e){r.addEdge(o,e)})}),r},module.exports=function(e){return new ModuleLoader(e)};
},{"./Graph":1,"./Utils":4}],3:[function(require,module,exports){
function ModuleManager(e){this.moduleInstaller=require("./ModuleInstaller")(),this.moduleLoader=require("./ModuleLoader")(),this._modulesLoaded={}}var Utils=require("./Utils");ModuleManager.prototype.installModules=function(e,o){var l=this.moduleInstaller,r=0,t={};Utils.objectForEach(e,function(e,n){void 0!==e.npm&&"string"!=typeof e.require&&(r++,l.installNpmModule(e.npm,function(l,u){r--,t[n]={error:l,install:u},l||(e.require=u.name),0==r&&o(t)}))}),0==r&&o(t)},ModuleManager.prototype.loadModules=function(e,o){var l=this;try{this.moduleLoader.load(e,l._modulesLoaded),o(null,l._modulesLoaded)}catch(e){o(e,l._modulesLoaded)}},ModuleManager.prototype.installLoadModules=function(e,o){var l=this;l.installModules(e,function(r){var t=!1;Utils.objectForEach(r,function(e){null!=e.error&&(t=!0)}),t?o(r,null):l.loadModules(e,o)})},module.exports=function(e){return new ModuleManager(e)};
},{"./ModuleInstaller":undefined,"./ModuleLoader":2,"./Utils":4}],4:[function(require,module,exports){
var Utils={};Utils.objectForEach=function(r,e){var t;for(t in r)r.hasOwnProperty(t)&&e(r[t],t,r)},Utils.parseArgs=function(r,e){function t(r,e){return"function"!=typeof r.validate||r.validate(e)}function a(r,e){for(var t=e;t<r.length;t++)if(void 0===r[t]||!r[t].required)return!0;return!1}var i={},n=0;return Array.isArray(r)||(r=Array.prototype.slice.call(r)),r.forEach(function(r,o){for(var f=n;f<e.length;f++){if(e[f].required){if(t(e[f],r)){e[f].matched=!0,i[e[f].name]=r,n++;break}throw"missing_required"}if(!e[f].required&&(a(e,f)||e[f].level>e[f-1].level&&e[f-1].matched)&&t(e[f],r)){e[f].matched=!0,i[e[f].name]=r,n++;break}e[f].matched=!1,n++}}),e.forEach(function(r){void 0===i[r.name]&&void 0!==r.default&&(i[r.name]=r.default)}),i},module.exports=Utils;
},{}]},{},[3])(3)
});


//# sourceMappingURL=moduleinstallerloader.js.map